import { Card, Row, Table, Col, Statistic } from "antd";
import React, { useState, useEffect } from "react";
import { EXCHANGEARRAYS } from "../../constants";
import { ReactComponent as Binancesvg } from "./../assets/exchanges/binance.svg";
import { ReactComponent as Bitfinexsvg } from "./../assets/exchanges/bitfinex.svg";
import { ReactComponent as Bithumbsvg } from "./../assets/exchanges/bithumb.svg";
import { ReactComponent as Bitstampsvg } from "./../assets/exchanges/bitstamp.svg";
import { ReactComponent as Coinbasesvg } from "./../assets/exchanges/coinbase.svg";
import { ReactComponent as Huobisvg } from "./../assets/exchanges/huobi.svg";
import { ReactComponent as Krakensvg } from "./../assets/exchanges/kraken.svg";
import { ReactComponent as Kucoinsvg } from "./../assets/exchanges/kucoin.svg";
import { ReactComponent as Okxsvg } from "./../assets/exchanges/okx.svg";
import Icon from "@ant-design/icons";
import {
  processingfetchingMarketPrices,
  reflectPrices,
} from "../../common/script";
const { Countdown } = Statistic;
let pricesTimer;
let upgradeTime = 90000;
const AutoTrading = (props) => {
  const [pricesState, setPricesData] = useState([]);
  const [progressState, setProgress] = useState(0);
  let deadline = Date.now() + 1000 * 60; // Moment is also OK
  useEffect(() => {
    async function asyncFetchStates() {
      setPricesData(await processingfetchingMarketPrices());
    }

    asyncFetchStates();
    pricesTimer = setInterval(() => asyncFetchStates(), upgradeTime);
    return () => {
      clearInterval(pricesTimer);
    };
  }, []);
  const columns = [
    { title: "Currency", dataIndex: "currency", key: "currency" },
    { title: "Cash in, Cash out", dataIndex: "cash", key: "cash" },
    {
      title: "Amount",
      dataIndex: "amount",
      key: "amount",
    },
    {
      title: "ROI",
      dataIndex: "roi",
      key: "roi",
    },
  ];
  const tableData = reflectPrices(pricesState, EXCHANGEARRAYS.length);
  return (
    <Col>
      <Row>
        <Card
          style={{ width: "100%" }}
          bodyStyle={{ padding: "5px" }}
          title="Available exchanges : 9"
        >
          <Row>
            <p style={{ color: "#5e636e", marginBottom: "3px" }}>
              To increase the number of exchanges, upgrade your plan
            </p>
          </Row>
          <Row>
            <h4>Market Positions</h4>
          </Row>
          <Row>
            <Countdown title="Next update in" value={deadline} />
          </Row>
          <Row>
            <Col xs={24} sm={24} md={12} lg={12} style={{ padding: "5px" }}>
              {EXCHANGEARRAYS.map((array, index) => (
                <Row span={24} style={{ padding: "5px" }}>
                  <Card
                    style={{
                      width: "100%",
                    }}
                    key={index}
                    bodyStyle={{ padding: 3 }}
                  >
                    <Row>
                      <Col span={6} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            VOLUME, 24H
                          </p>
                        </Row>
                        <Row>
                          <h6>{tableData[index].volume}</h6>
                        </Row>
                      </Col>
                      <Col span={5} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            CHANGE, 24H
                          </p>
                        </Row>
                        <Row>{tableData[index].change}</Row>
                      </Col>
                      <Col span={5} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            Sell
                          </p>
                        </Row>
                        <Row>
                          <h6>{tableData[index].sell}</h6>
                        </Row>
                      </Col>
                      <Col span={8} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            EXCHANGE
                          </p>
                        </Row>
                        <Row>
                          <Card
                            bodyStyle={{ padding: 3 }}
                            style={{ width: "100%" }}
                          >
                            <Row
                              style={{
                                justifyContent: "center",
                                alignItems: "center",
                              }}
                            >
                              {index === 0 ? (
                                <Icon
                                  component={Binancesvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 1 ? (
                                <Icon
                                  component={Coinbasesvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 2 ? (
                                <Icon
                                  component={Krakensvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 3 ? (
                                <Icon
                                  component={Huobisvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 4 ? (
                                <Icon
                                  component={Bitfinexsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 5 ? (
                                <Icon
                                  component={Bithumbsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 6 ? (
                                <Icon
                                  component={Kucoinsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 7 ? (
                                <Icon
                                  component={Bitstampsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 8 ? (
                                <Icon
                                  component={Okxsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : (
                                <></>
                              )}
                              <p
                                style={{
                                  color: "#5e636e",
                                  marginBottom: 0,
                                  marginLeft: 5,
                                }}
                              >
                                {array.title}
                              </p>
                            </Row>
                          </Card>
                        </Row>
                      </Col>
                    </Row>
                  </Card>
                </Row>
              ))}
            </Col>
            <Col xs={24} sm={24} md={12} lg={12} style={{ padding: "5px" }}>
              {EXCHANGEARRAYS.map((array, index) => (
                <Row span={24} style={{ padding: "5px" }}>
                  <Card
                    style={{
                      width: "100%",
                    }}
                    key={index}
                    bodyStyle={{ padding: 3 }}
                  >
                    <Row>
                      <Col span={8} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            EXCHANGE
                          </p>
                        </Row>
                        <Row>
                          <Card
                            bodyStyle={{ padding: 3 }}
                            style={{ width: "100%" }}
                          >
                            <Row
                              style={{
                                justifyContent: "center",
                                alignItems: "center",
                              }}
                            >
                              {index === 0 ? (
                                <Icon
                                  component={Binancesvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 1 ? (
                                <Icon
                                  component={Coinbasesvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 2 ? (
                                <Icon
                                  component={Krakensvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 3 ? (
                                <Icon
                                  component={Huobisvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 4 ? (
                                <Icon
                                  component={Bitfinexsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 5 ? (
                                <Icon
                                  component={Bithumbsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 6 ? (
                                <Icon
                                  component={Kucoinsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 7 ? (
                                <Icon
                                  component={Bitstampsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : index === 8 ? (
                                <Icon
                                  component={Okxsvg}
                                  style={{ fontSize: "20px", marginRight: 1 }}
                                />
                              ) : (
                                <></>
                              )}
                              <p
                                style={{
                                  color: "#5e636e",
                                  marginBottom: 0,
                                  marginLeft: 5,
                                }}
                              >
                                {array.title}
                              </p>
                            </Row>
                          </Card>
                        </Row>
                      </Col>
                      <Col span={5} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            Buy
                          </p>
                        </Row>
                        <Row>
                          <h6>{tableData[index].buy}</h6>
                        </Row>
                      </Col>
                      <Col span={5} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            CHANGE, 24H
                          </p>
                        </Row>
                        <Row>{tableData[index].change}</Row>
                      </Col>
                      <Col span={6} style={{ padding: "5px" }}>
                        <Row>
                          <p style={{ color: "#5e636e", marginBottom: "3px" }}>
                            VOLUME, 24H
                          </p>
                        </Row>
                        <Row>
                          <h6>{tableData[index].volume}</h6>
                        </Row>
                      </Col>
                    </Row>
                  </Card>
                </Row>
              ))}
            </Col>
          </Row>
        </Card>
      </Row>
      <Row>
        <Table
          style={{ width: "100%", marginTop: 10 }}
          columns={columns}
          scroll={{ x: "100%" }}
        />
      </Row>
    </Col>
  );
};
export default AutoTrading;
